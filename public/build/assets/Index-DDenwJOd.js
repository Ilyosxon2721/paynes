import{r as d,y as j,z as m,a as o,o as n,b as e,i as w,t as r,F as h,e as k,k as B,j as p,l as f,n as b,B as I,h as F,G as N}from"./app-DmhU3QBQ.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";const L={class:"users-page"},A={key:0,class:"loading"},H={key:1,class:"alert alert-error"},J={key:2,class:"table-card"},K={class:"data-table"},O={class:"action-buttons"},Q=["onClick"],W=["onClick"],X={class:"modal-header"},Y={class:"modal-body"},Z={class:"form-row"},ee={class:"form-group"},se={key:0,class:"error-message"},le={class:"form-group"},ae={key:0,class:"error-message"},te={class:"form-row"},oe={class:"form-group"},ne={for:"password"},re=["required"],ie={key:0,class:"error-message"},ue={class:"form-group"},de={class:"form-row"},pe={class:"form-group"},ve={class:"form-group"},ce={class:"form-group"},me={class:"form-group"},fe={class:"checkbox-group"},be=["value"],ge={class:"form-group"},_e={class:"checkbox-group"},ye=["value"],we={class:"modal-footer"},he=["disabled"],ke={__name:"Index",setup(xe){const q=d([]),x=d(!1),g=d(null),_=d(!1),c=d(!1),C=d(null),y=d(!1),i=d({}),E=d([]),$=d([]),U={login:"",full_name:"",password:"",position:"cashier",status:"active",branch:"",reward_percentage:0,roles:[],permissions:[]},t=d({...U});j(async()=>{await Promise.all([V(),P(),S()])});async function V(){var a,s;x.value=!0,g.value=null;try{const l=await m.get("/users");l.data.success&&(q.value=l.data.data)}catch(l){g.value=((s=(a=l.response)==null?void 0:a.data)==null?void 0:s.message)||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤"}finally{x.value=!1}}async function P(){try{const a=await m.get("/users/roles");a.data.success&&(E.value=a.data.data)}catch(a){console.error("Error loading roles:",a)}}async function S(){try{const a=await m.get("/users/permissions");a.data.success&&($.value=a.data.data)}catch(a){console.error("Error loading permissions:",a)}}function z(){c.value=!1,C.value=null,t.value={...U,roles:[],permissions:[]},i.value={},_.value=!0}function D(a){c.value=!0,C.value=a.id,t.value={login:a.login,full_name:a.full_name,password:"",position:a.position,status:a.status,branch:a.branch||"",reward_percentage:a.reward_percentage||0,roles:a.roles||[],permissions:a.permissions||[]},i.value={},_.value=!0}function M(){_.value=!1,t.value={...U},i.value={}}async function R(){var a,s,l,u;y.value=!0,i.value={};try{const v={...t.value};c.value&&!v.password&&delete v.password,c.value?await m.put(`/users/${C.value}`,v):await m.post("/users",v),await V(),M()}catch(v){(s=(a=v.response)==null?void 0:a.data)!=null&&s.errors?i.value=v.response.data.errors:alert(((u=(l=v.response)==null?void 0:l.data)==null?void 0:u.message)||"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞")}finally{y.value=!1}}async function T(a){var s,l;if(confirm("–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞?"))try{await m.delete(`/users/${a}`),await V()}catch(u){alert(((l=(s=u.response)==null?void 0:s.data)==null?void 0:l.message)||"–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞")}}return(a,s)=>(n(),o("div",L,[e("div",{class:"page-header"},[s[10]||(s[10]=e("h1",{class:"page-title"},"–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏",-1)),e("button",{onClick:z,class:"btn btn-primary"}," + –î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ ")]),x.value?(n(),o("div",A,"–ó–∞–≥—Ä—É–∑–∫–∞...")):g.value?(n(),o("div",H,r(g.value),1)):(n(),o("div",J,[e("table",K,[s[11]||(s[11]=e("thead",null,[e("tr",null,[e("th",null,"–õ–æ–≥–∏–Ω"),e("th",null,"–§–ò–û"),e("th",null,"–î–æ–ª–∂–Ω–æ—Å—Ç—å"),e("th",null,"–§–∏–ª–∏–∞–ª"),e("th",null,"–°—Ç–∞—Ç—É—Å"),e("th",null,"–†–æ–ª–∏"),e("th",null,"–î–µ–π—Å—Ç–≤–∏—è")])],-1)),e("tbody",null,[(n(!0),o(h,null,k(q.value,l=>(n(),o("tr",{key:l.id},[e("td",null,r(l.login),1),e("td",null,r(l.full_name),1),e("td",null,[e("span",{class:b(["badge",`badge-${l.position}`])},r(l.position==="admin"?"–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä":"–ö–∞—Å—Å–∏—Ä"),3)]),e("td",null,r(l.branch||"-"),1),e("td",null,[e("span",{class:b(["badge",`badge-${l.status}`])},r(l.status==="active"?"–ê–∫—Ç–∏–≤–µ–Ω":"–ù–µ–∞–∫—Ç–∏–≤–µ–Ω"),3)]),e("td",null,[(n(!0),o(h,null,k(l.roles,u=>(n(),o("span",{key:u,class:"role-tag"},r(u),1))),128))]),e("td",null,[e("div",O,[e("button",{onClick:u=>D(l),class:"btn-action btn-edit",title:"–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å"}," ‚úèÔ∏è ",8,Q),e("button",{onClick:u=>T(l.id),class:"btn-action btn-delete",title:"–£–¥–∞–ª–∏—Ç—å"}," üóëÔ∏è ",8,W)])])]))),128))])])])),_.value?(n(),o("div",{key:3,class:"modal-overlay",onClick:M},[e("div",{class:"modal-content large",onClick:s[9]||(s[9]=B(()=>{},["stop"]))},[e("div",X,[e("h2",null,r(c.value?"–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞":"–î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞"),1)]),e("div",Y,[e("form",{onSubmit:B(R,["prevent"])},[e("div",Z,[e("div",ee,[s[12]||(s[12]=e("label",{for:"login"},"–õ–æ–≥–∏–Ω *",-1)),p(e("input",{id:"login","onUpdate:modelValue":s[0]||(s[0]=l=>t.value.login=l),type:"text",class:b(["form-input",{error:i.value.login}]),required:""},null,2),[[f,t.value.login]]),i.value.login?(n(),o("span",se,r(i.value.login[0]),1)):w("",!0)]),e("div",le,[s[13]||(s[13]=e("label",{for:"full_name"},"–§–ò–û *",-1)),p(e("input",{id:"full_name","onUpdate:modelValue":s[1]||(s[1]=l=>t.value.full_name=l),type:"text",class:b(["form-input",{error:i.value.full_name}]),required:""},null,2),[[f,t.value.full_name]]),i.value.full_name?(n(),o("span",ae,r(i.value.full_name[0]),1)):w("",!0)])]),e("div",te,[e("div",oe,[e("label",ne,"–ü–∞—Ä–æ–ª—å "+r(c.value?"(–æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º, —á—Ç–æ–±—ã –Ω–µ –º–µ–Ω—è—Ç—å)":"*"),1),p(e("input",{id:"password","onUpdate:modelValue":s[2]||(s[2]=l=>t.value.password=l),type:"password",class:b(["form-input",{error:i.value.password}]),required:!c.value},null,10,re),[[f,t.value.password]]),i.value.password?(n(),o("span",ie,r(i.value.password[0]),1)):w("",!0)]),e("div",ue,[s[15]||(s[15]=e("label",{for:"position"},"–î–æ–ª–∂–Ω–æ—Å—Ç—å *",-1)),p(e("select",{id:"position","onUpdate:modelValue":s[3]||(s[3]=l=>t.value.position=l),class:"form-select",required:""},[...s[14]||(s[14]=[e("option",{value:"admin"},"–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä",-1),e("option",{value:"cashier"},"–ö–∞—Å—Å–∏—Ä",-1)])],512),[[I,t.value.position]])])]),e("div",de,[e("div",pe,[s[16]||(s[16]=e("label",{for:"branch"},"–§–∏–ª–∏–∞–ª",-1)),p(e("input",{id:"branch","onUpdate:modelValue":s[4]||(s[4]=l=>t.value.branch=l),type:"text",class:"form-input"},null,512),[[f,t.value.branch]])]),e("div",ve,[s[18]||(s[18]=e("label",{for:"status"},"–°—Ç–∞—Ç—É—Å *",-1)),p(e("select",{id:"status","onUpdate:modelValue":s[5]||(s[5]=l=>t.value.status=l),class:"form-select",required:""},[...s[17]||(s[17]=[e("option",{value:"active"},"–ê–∫—Ç–∏–≤–µ–Ω",-1),e("option",{value:"inactive"},"–ù–µ–∞–∫—Ç–∏–≤–µ–Ω",-1)])],512),[[I,t.value.status]])])]),e("div",ce,[s[19]||(s[19]=e("label",{for:"reward_percentage"},"–ü—Ä–æ—Ü–µ–Ω—Ç –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏—è (%)",-1)),p(e("input",{id:"reward_percentage","onUpdate:modelValue":s[6]||(s[6]=l=>t.value.reward_percentage=l),type:"number",step:"0.01",min:"0",max:"100",class:"form-input",placeholder:"0.00"},null,512),[[f,t.value.reward_percentage,void 0,{number:!0}]])]),e("div",me,[s[20]||(s[20]=e("label",null,"–†–æ–ª–∏",-1)),e("div",fe,[(n(!0),o(h,null,k(E.value,l=>(n(),o("label",{key:l.id,class:"checkbox-label"},[p(e("input",{type:"checkbox",value:l.name,"onUpdate:modelValue":s[7]||(s[7]=u=>t.value.roles=u)},null,8,be),[[N,t.value.roles]]),F(" "+r(l.name),1)]))),128))])]),e("div",ge,[s[21]||(s[21]=e("label",null,"–ü—Ä–∏–≤–∏–ª–µ–≥–∏–∏",-1)),e("div",_e,[(n(!0),o(h,null,k($.value,l=>(n(),o("label",{key:l.id,class:"checkbox-label"},[p(e("input",{type:"checkbox",value:l.name,"onUpdate:modelValue":s[8]||(s[8]=u=>t.value.permissions=u)},null,8,ye),[[N,t.value.permissions]]),F(" "+r(l.name),1)]))),128))])]),e("div",we,[e("button",{type:"submit",class:"btn btn-primary",disabled:y.value},r(y.value?"–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...":"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"),9,he),e("button",{type:"button",onClick:M,class:"btn btn-secondary"}," –û—Ç–º–µ–Ω–∞ ")])],32)])])])):w("",!0)]))}},Ve=G(ke,[["__scopeId","data-v-1f1622ba"]]);export{Ve as default};
