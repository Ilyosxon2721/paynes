import{r as v,x as O,y as P,c as j,a as u,o as r,i as w,b as e,t as c,g as I,k as L,j as b,l as y,F as Q,e as R,z as $,q as T,d as g,w as k,f as Z,s as q,u as A,h as z}from"./app-DmhU3QBQ.js";import{_ as D}from"./_plugin-vue_export-helper-DlAUqK2U.js";const E={class:"shift-controls"},G={key:0,class:"shift-status shift-status--open"},H={class:"shift-status__info"},J={class:"shift-status__time"},K={key:1,class:"shift-status shift-status--closed"},W={class:"modal"},X={class:"modal__header"},Y={class:"modal__body"},ss={class:"form-grid"},es={class:"form-group"},ts={class:"form-group"},ls={class:"form-group"},as={class:"form-group"},ns={class:"form-group"},os={class:"form-group"},is={key:0,class:"alert alert--danger"},us={class:"modal__footer"},rs=["disabled"],ds=["disabled"],cs={class:"modal"},_s={class:"modal__header"},vs={class:"modal__body"},ps={key:0,class:"alert alert--warning"},ms={key:1},fs={key:0,class:"balances-preview"},gs={class:"balances-preview__grid"},hs={class:"balance-item"},bs={class:"balance-item__value"},ys={class:"balance-item"},ws={class:"balance-item__value"},ks={class:"balance-item"},zs={class:"balance-item__value"},Ss={class:"balance-item"},Cs={class:"balance-item__value"},xs={class:"balance-item"},$s={class:"balance-item__value"},Us={class:"form-group"},Vs={key:2,class:"alert alert--danger"},Ls={class:"modal__footer"},Zs=["disabled"],Ds=["disabled"],Bs={__name:"ShiftControls",emits:["shift-opened","shift-closed","shift-changed"],setup(B,{expose:U,emit:x}){const p=x,n=v(null),f=v(!1),m=v(!1),d=v(!1),o=v(null),a=v(null),_=v({can_close:!0,errors:[]}),l=v({opening_cash_uzs:null,opening_cashless_uzs:null,opening_card_uzs:null,opening_p2p_uzs:null,opening_cash_usd:null,opening_notes:""}),h=v({closing_notes:""}),V=async()=>{try{const i=await $.get("/cashier-shifts/current");n.value=i.data.data,p("shift-changed",n.value)}catch(i){console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ç–µ–∫—É—â–µ–π —Å–º–µ–Ω—ã:",i)}},F=async()=>{var i,s;d.value=!0,o.value=null;try{const t={};l.value.opening_cash_uzs!==null&&(t.opening_cash_uzs=l.value.opening_cash_uzs),l.value.opening_cashless_uzs!==null&&(t.opening_cashless_uzs=l.value.opening_cashless_uzs),l.value.opening_card_uzs!==null&&(t.opening_card_uzs=l.value.opening_card_uzs),l.value.opening_p2p_uzs!==null&&(t.opening_p2p_uzs=l.value.opening_p2p_uzs),l.value.opening_cash_usd!==null&&(t.opening_cash_usd=l.value.opening_cash_usd),l.value.opening_notes&&(t.opening_notes=l.value.opening_notes);const C=await $.post("/cashier-shifts/open",t);n.value=C.data.data,f.value=!1,l.value={opening_cash_uzs:null,opening_cashless_uzs:null,opening_card_uzs:null,opening_p2p_uzs:null,opening_cash_usd:null,opening_notes:""},p("shift-opened",n.value),p("shift-changed",n.value)}catch(t){o.value=((s=(i=t.response)==null?void 0:i.data)==null?void 0:s.message)||"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å–º–µ–Ω—ã"}finally{d.value=!1}},M=async()=>{var i,s;if(n.value){d.value=!0,o.value=null;try{const C=(await $.post(`/cashier-shifts/${n.value.id}/close`,h.value)).data.data;n.value=null,m.value=!1,h.value={closing_notes:""},a.value=null,p("shift-closed",C),p("shift-changed",null)}catch(t){o.value=((s=(i=t.response)==null?void 0:i.data)==null?void 0:s.message)||"–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —Å–º–µ–Ω—ã"}finally{d.value=!1}}};O(m,async i=>{if(i&&n.value)try{const s=await $.get(`/cashier-shifts/${n.value.id}/report`);a.value=s.data.data.balances,s.data.data.shift.status==="open"&&(_.value={can_close:!0,errors:[]})}catch(s){console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö —Å–º–µ–Ω—ã:",s)}});const N=(i,s)=>new Date(`${i} ${s}`).toLocaleString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),S=(i,s="UZS")=>`${new Intl.NumberFormat("ru-RU",{minimumFractionDigits:2,maximumFractionDigits:2}).format(i||0)} ${s}`;return P(()=>{V()}),U({currentShift:j(()=>n.value),reload:V}),(i,s)=>(r(),u("div",E,[n.value?(r(),u("div",G,[s[16]||(s[16]=e("div",{class:"shift-status__icon"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("polyline",{points:"12 6 12 12 16 14"})])],-1)),e("div",H,[s[15]||(s[15]=e("div",{class:"shift-status__label"},"–°–º–µ–Ω–∞ –æ—Ç–∫—Ä—ã—Ç–∞",-1)),e("div",J,c(N(n.value.shift_date,n.value.opened_at)),1)]),e("button",{onClick:s[0]||(s[0]=t=>m.value=!0),class:"btn btn--danger btn--sm"}," –ó–∞–∫—Ä—ã—Ç—å —Å–º–µ–Ω—É ")])):(r(),u("div",K,[s[17]||(s[17]=I('<div class="shift-status__icon" data-v-e1caa39a><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-e1caa39a><circle cx="12" cy="12" r="10" data-v-e1caa39a></circle><line x1="4.93" y1="4.93" x2="19.07" y2="19.07" data-v-e1caa39a></line></svg></div><div class="shift-status__info" data-v-e1caa39a><div class="shift-status__label" data-v-e1caa39a>–°–º–µ–Ω–∞ –∑–∞–∫—Ä—ã—Ç–∞</div><div class="shift-status__subtitle" data-v-e1caa39a>–û—Ç–∫—Ä–æ–π—Ç–µ —Å–º–µ–Ω—É –¥–ª—è —Ä–∞–±–æ—Ç—ã</div></div>',2)),e("button",{onClick:s[1]||(s[1]=t=>f.value=!0),class:"btn btn--primary btn--sm"}," –û—Ç–∫—Ä—ã—Ç—å —Å–º–µ–Ω—É ")])),f.value?(r(),u("div",{key:2,class:"modal-overlay",onClick:s[10]||(s[10]=L(t=>f.value=!1,["self"]))},[e("div",W,[e("div",X,[s[18]||(s[18]=e("h3",{class:"modal__title"},"–û—Ç–∫—Ä—ã—Ç—å —Å–º–µ–Ω—É",-1)),e("button",{onClick:s[2]||(s[2]=t=>f.value=!1),class:"modal__close"},"√ó")]),e("div",Y,[s[25]||(s[25]=e("p",{class:"modal__description"}," –£–∫–∞–∂–∏—Ç–µ –Ω–∞—á–∞–ª—å–Ω—ã–µ –±–∞–ª–∞–Ω—Å—ã –∫–∞—Å—Å—ã. –ï—Å–ª–∏ –æ—Å—Ç–∞–≤–∏—Ç—å –ø–æ–ª—è –ø—É—Å—Ç—ã–º–∏, –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –±–∞–ª–∞–Ω—Å—ã –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å–º–µ–Ω—ã. ",-1)),e("div",ss,[e("div",es,[s[19]||(s[19]=e("label",{class:"form-label"},"–ù–∞–ª–∏—á–Ω—ã–µ UZS",-1)),b(e("input",{"onUpdate:modelValue":s[3]||(s[3]=t=>l.value.opening_cash_uzs=t),type:"number",step:"0.01",class:"form-control",placeholder:"–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏"},null,512),[[y,l.value.opening_cash_uzs,void 0,{number:!0}]])]),e("div",ts,[s[20]||(s[20]=e("label",{class:"form-label"},"–ë–µ–∑–Ω–∞–ª–∏—á–Ω—ã–µ UZS",-1)),b(e("input",{"onUpdate:modelValue":s[4]||(s[4]=t=>l.value.opening_cashless_uzs=t),type:"number",step:"0.01",class:"form-control",placeholder:"–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏"},null,512),[[y,l.value.opening_cashless_uzs,void 0,{number:!0}]])]),e("div",ls,[s[21]||(s[21]=e("label",{class:"form-label"},"–ö–∞—Ä—Ç—ã UZS",-1)),b(e("input",{"onUpdate:modelValue":s[5]||(s[5]=t=>l.value.opening_card_uzs=t),type:"number",step:"0.01",class:"form-control",placeholder:"–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏"},null,512),[[y,l.value.opening_card_uzs,void 0,{number:!0}]])]),e("div",as,[s[22]||(s[22]=e("label",{class:"form-label"},"P2P UZS",-1)),b(e("input",{"onUpdate:modelValue":s[6]||(s[6]=t=>l.value.opening_p2p_uzs=t),type:"number",step:"0.01",class:"form-control",placeholder:"–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏"},null,512),[[y,l.value.opening_p2p_uzs,void 0,{number:!0}]])]),e("div",ns,[s[23]||(s[23]=e("label",{class:"form-label"},"–ù–∞–ª–∏—á–Ω—ã–µ USD",-1)),b(e("input",{"onUpdate:modelValue":s[7]||(s[7]=t=>l.value.opening_cash_usd=t),type:"number",step:"0.01",class:"form-control",placeholder:"–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏"},null,512),[[y,l.value.opening_cash_usd,void 0,{number:!0}]])])]),e("div",os,[s[24]||(s[24]=e("label",{class:"form-label"},"–ü—Ä–∏–º–µ—á–∞–Ω–∏—è",-1)),b(e("textarea",{"onUpdate:modelValue":s[8]||(s[8]=t=>l.value.opening_notes=t),class:"form-control",rows:"3",placeholder:"–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å–º–µ–Ω—ã"},null,512),[[y,l.value.opening_notes]])]),o.value?(r(),u("div",is,c(o.value),1)):w("",!0)]),e("div",us,[e("button",{onClick:s[9]||(s[9]=t=>f.value=!1),class:"btn btn--secondary",disabled:d.value}," –û—Ç–º–µ–Ω–∞ ",8,rs),e("button",{onClick:F,class:"btn btn--primary",disabled:d.value},c(d.value?"–û—Ç–∫—Ä—ã—Ç–∏–µ...":"–û—Ç–∫—Ä—ã—Ç—å —Å–º–µ–Ω—É"),9,ds)])])])):w("",!0),m.value?(r(),u("div",{key:3,class:"modal-overlay",onClick:s[14]||(s[14]=L(t=>m.value=!1,["self"]))},[e("div",cs,[e("div",_s,[s[26]||(s[26]=e("h3",{class:"modal__title"},"–ó–∞–∫—Ä—ã—Ç—å —Å–º–µ–Ω—É",-1)),e("button",{onClick:s[11]||(s[11]=t=>m.value=!1),class:"modal__close"},"√ó")]),e("div",vs,[_.value.errors.length>0?(r(),u("div",ps,[s[27]||(s[27]=e("strong",null,"–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –∑–∞–∫—Ä—ã—Ç—å —Å–º–µ–Ω—É:",-1)),e("ul",null,[(r(!0),u(Q,null,R(_.value.errors,(t,C)=>(r(),u("li",{key:C},c(t),1))),128))])])):(r(),u("div",ms,[s[35]||(s[35]=e("p",{class:"modal__description"}," –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –∑–∞–∫—Ä—ã—Ç–∏–µ —Å–º–µ–Ω—ã. –ò—Ç–æ–≥–æ–≤—ã–µ –±–∞–ª–∞–Ω—Å—ã –±—É–¥—É—Ç —Ä–∞—Å—Å—á–∏—Ç–∞–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. ",-1)),a.value?(r(),u("div",fs,[s[33]||(s[33]=e("h4",{class:"balances-preview__title"},"–ò—Ç–æ–≥–æ–≤—ã–µ –±–∞–ª–∞–Ω—Å—ã:",-1)),e("div",gs,[e("div",hs,[s[28]||(s[28]=e("span",{class:"balance-item__label"},"–ù–∞–ª–∏—á–Ω—ã–µ UZS:",-1)),e("span",bs,c(S(a.value.cash_uzs)),1)]),e("div",ys,[s[29]||(s[29]=e("span",{class:"balance-item__label"},"–ë–µ–∑–Ω–∞–ª–∏—á–Ω—ã–µ UZS:",-1)),e("span",ws,c(S(a.value.cashless_uzs)),1)]),e("div",ks,[s[30]||(s[30]=e("span",{class:"balance-item__label"},"–ö–∞—Ä—Ç—ã UZS:",-1)),e("span",zs,c(S(a.value.card_uzs)),1)]),e("div",Ss,[s[31]||(s[31]=e("span",{class:"balance-item__label"},"P2P UZS:",-1)),e("span",Cs,c(S(a.value.p2p_uzs)),1)]),e("div",xs,[s[32]||(s[32]=e("span",{class:"balance-item__label"},"–ù–∞–ª–∏—á–Ω—ã–µ USD:",-1)),e("span",$s,c(S(a.value.cash_usd,"USD")),1)])])])):w("",!0),e("div",Us,[s[34]||(s[34]=e("label",{class:"form-label"},"–ü—Ä–∏–º–µ—á–∞–Ω–∏—è –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏",-1)),b(e("textarea",{"onUpdate:modelValue":s[12]||(s[12]=t=>h.value.closing_notes=t),class:"form-control",rows:"3",placeholder:"–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —Å–º–µ–Ω—ã"},null,512),[[y,h.value.closing_notes]])])])),o.value?(r(),u("div",Vs,c(o.value),1)):w("",!0)]),e("div",Ls,[e("button",{onClick:s[13]||(s[13]=t=>m.value=!1),class:"btn btn--secondary",disabled:d.value}," –û—Ç–º–µ–Ω–∞ ",8,Zs),_.value.errors.length===0?(r(),u("button",{key:0,onClick:M,class:"btn btn--danger",disabled:d.value},c(d.value?"–ó–∞–∫—Ä—ã—Ç–∏–µ...":"–ó–∞–∫—Ä—ã—Ç—å —Å–º–µ–Ω—É"),9,Ds)):w("",!0)])])])):w("",!0)]))}},Fs=D(Bs,[["__scopeId","data-v-e1caa39a"]]),Ms={class:"layout"},Ns={class:"sidebar"},Os={class:"sidebar-nav"},Ps={class:"sidebar-footer"},js={class:"user-info"},Is={class:"user-name"},Qs={class:"main-content"},Rs={class:"shift-controls-container"},Ts={__name:"CashierLayout",setup(B){const U=A(),x=T(),p=v(null);async function n(){await x.logout(),U.push({name:"Login"})}function f(o){p.value=o,console.log("–°–º–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ –æ—Ç–∫—Ä—ã—Ç–∞",o)}function m(o){p.value=null,console.log("–°–º–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ –∑–∞–∫—Ä—ã—Ç–∞",o)}function d(o){p.value=o}return(o,a)=>{var h;const _=Z("router-link"),l=Z("router-view");return r(),u("div",Ms,[e("aside",Ns,[a[7]||(a[7]=e("div",{class:"sidebar-header"},[e("svg",{class:"logo",viewBox:"0 0 200 200",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M 50 150 L 50 50 Q 50 30 70 30 L 120 30 Q 150 30 150 60 Q 150 90 120 90 L 80 90 L 120 130 L 80 130 Z",fill:"white",stroke:"none"})]),e("h1",null,"Paynes"),e("p",{class:"tagline"},"–ü–ª–∞—Ç–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞")],-1)),e("nav",Os,[g(_,{to:"/cashier",class:"nav-item",exact:""},{default:k(()=>[...a[0]||(a[0]=[e("span",null,"üè†",-1),z(" –ì–ª–∞–≤–Ω–∞—è ",-1)])]),_:1}),g(_,{to:"/cashier/payments",class:"nav-item"},{default:k(()=>[...a[1]||(a[1]=[e("span",null,"üí≥",-1),z(" –ü–ª–∞—Ç–µ–∂–∏ ",-1)])]),_:1}),g(_,{to:"/cashier/exchanges",class:"nav-item"},{default:k(()=>[...a[2]||(a[2]=[e("span",null,"üí±",-1),z(" –û–±–º–µ–Ω –≤–∞–ª—é—Ç ",-1)])]),_:1}),g(_,{to:"/cashier/credits",class:"nav-item"},{default:k(()=>[...a[3]||(a[3]=[e("span",null,"üí∞",-1),z(" –ö—Ä–µ–¥–∏—Ç—ã ",-1)])]),_:1}),g(_,{to:"/cashier/incashes",class:"nav-item"},{default:k(()=>[...a[4]||(a[4]=[e("span",null,"üß∞",-1),z(" –ò–Ω–∫–∞—Å—Å–∞—Ü–∏—è ",-1)])]),_:1}),g(_,{to:"/cashier/tickets",class:"nav-item"},{default:k(()=>[...a[5]||(a[5]=[e("span",null,"üí¨",-1),z(" –ß–∞—Ç/–¢–∏–∫–µ—Ç—ã ",-1)])]),_:1})]),e("div",Ps,[e("div",js,[e("div",Is,c((h=q(x).user)==null?void 0:h.full_name),1),a[6]||(a[6]=e("div",{class:"user-position"},"–ö–∞—Å—Å–∏—Ä",-1))]),e("button",{onClick:n,class:"logout-btn"},"–í—ã–π—Ç–∏")])]),e("main",Qs,[e("div",Rs,[g(Fs,{onShiftOpened:f,onShiftClosed:m,onShiftChanged:d})]),g(l)])])}}},Es=D(Ts,[["__scopeId","data-v-d24ec3e3"]]);export{Es as default};
