import{r,y as D,z as m,a as n,o,b as t,i as w,t as i,k as U,j as g,l as h,F,e as I}from"./app-DmhU3QBQ.js";import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";const V={class:"rates-page"},$={class:"page-header"},N={key:0,class:"form-modal"},q={class:"form-card"},B={class:"form-header"},M={class:"form-row"},T={class:"form-group"},E={class:"form-group"},O={class:"form-group"},Z={key:0,class:"alert alert-error"},j={class:"form-actions"},z=["disabled"],L={key:1,class:"loading"},A={key:2,class:"empty-state"},G={key:3,class:"table-card"},H={class:"data-table"},J={class:"font-weight-bold"},K={class:"text-small"},P={class:"action-buttons"},Q=["onClick"],W=["onClick"],X={__name:"Index",setup(Y){const _=r([]),b=r(!1),c=r(!1),u=r(null),s=r({buy_rate:0,sell_rate:0,date:new Date().toISOString().split("T")[0]}),d=r(null),v=r(!1);D(()=>p());async function p(){b.value=!0;try{const l=await m.get("/rates");l.data.success&&(_.value=l.data.data)}finally{b.value=!1}}function S(l){u.value=l,s.value={buy_rate:l.buy_rate,sell_rate:l.sell_rate,date:l.date},c.value=!0}function f(){c.value=!1,u.value=null,s.value={buy_rate:0,sell_rate:0,date:new Date().toISOString().split("T")[0]},d.value=null}async function C(){var l,e;d.value=null,v.value=!0;try{u.value?await m.put(`/rates/${u.value.id}`,s.value):await m.post("/rates",s.value),await p(),f()}catch(a){d.value=((e=(l=a.response)==null?void 0:l.data)==null?void 0:e.message)||"Ошибка сохранения"}finally{v.value=!1}}async function x(l){var e,a;if(confirm("Удалить курс?"))try{await m.delete(`/rates/${l}`),await p()}catch(y){alert(((a=(e=y.response)==null?void 0:e.data)==null?void 0:a.message)||"Ошибка")}}function k(l){return new Intl.NumberFormat("ru-RU",{minimumFractionDigits:2,maximumFractionDigits:2}).format(l)}return(l,e)=>(o(),n("div",V,[t("div",$,[e[4]||(e[4]=t("h1",{class:"page-title"},"Курсы валют",-1)),t("button",{onClick:e[0]||(e[0]=a=>c.value=!0),class:"btn btn-primary"},"+ Новый курс")]),c.value?(o(),n("div",N,[t("div",q,[t("div",B,[t("h2",null,i(u.value?"Редактировать курс":"Новый курс"),1),t("button",{onClick:f,class:"btn-close"},"×")]),t("form",{onSubmit:U(C,["prevent"])},[t("div",M,[t("div",T,[e[5]||(e[5]=t("label",{for:"buy_rate"},"Курс покупки *",-1)),g(t("input",{id:"buy_rate","onUpdate:modelValue":e[1]||(e[1]=a=>s.value.buy_rate=a),type:"number",step:"0.01",class:"form-input",placeholder:"12500.00",required:""},null,512),[[h,s.value.buy_rate,void 0,{number:!0}]])]),t("div",E,[e[6]||(e[6]=t("label",{for:"sell_rate"},"Курс продажи *",-1)),g(t("input",{id:"sell_rate","onUpdate:modelValue":e[2]||(e[2]=a=>s.value.sell_rate=a),type:"number",step:"0.01",class:"form-input",placeholder:"12600.00",required:""},null,512),[[h,s.value.sell_rate,void 0,{number:!0}]])]),t("div",O,[e[7]||(e[7]=t("label",{for:"date"},"Дата *",-1)),g(t("input",{id:"date","onUpdate:modelValue":e[3]||(e[3]=a=>s.value.date=a),type:"date",class:"form-input",required:""},null,512),[[h,s.value.date]])])]),d.value?(o(),n("div",Z,i(d.value),1)):w("",!0),t("div",j,[t("button",{type:"submit",class:"btn btn-primary",disabled:v.value},i(v.value?"Сохранение...":"Сохранить"),9,z),t("button",{type:"button",onClick:f,class:"btn btn-secondary"},"Отмена")])],32)])])):w("",!0),b.value?(o(),n("div",L,"Загрузка...")):_.value.length===0?(o(),n("div",A,[...e[8]||(e[8]=[t("p",null,"Курсы валют не найдены",-1)])])):(o(),n("div",G,[t("table",H,[e[9]||(e[9]=t("thead",null,[t("tr",null,[t("th",null,"Дата"),t("th",null,"Курс покупки USD"),t("th",null,"Курс продажи USD"),t("th",null,"Создано"),t("th",null,"Действия")])],-1)),t("tbody",null,[(o(!0),n(F,null,I(_.value,a=>(o(),n("tr",{key:a.id},[t("td",J,i(a.date),1),t("td",null,i(k(a.buy_rate))+" UZS",1),t("td",null,i(k(a.sell_rate))+" UZS",1),t("td",K,i(a.created_at),1),t("td",null,[t("div",P,[t("button",{onClick:y=>S(a),class:"btn-action btn-info",title:"Редактировать"},"✎",8,Q),t("button",{onClick:y=>x(a.id),class:"btn-action btn-danger",title:"Удалить"},"×",8,W)])])]))),128))])])]))]))}},at=R(X,[["__scopeId","data-v-4ec6cba9"]]);export{at as default};
