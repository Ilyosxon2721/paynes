import{r as c,c as g,y as N,z as S,a as u,o as i,b as e,d as U,w as h,f as V,j as F,h as p,i as w,B as R,n as x,t as o,k as B,u as E,g as D}from"./app-CmJRaKAb.js";import{_ as M}from"./_plugin-vue_export-helper-DlAUqK2U.js";const q={class:"create-exchange-page"},z={class:"page-header"},I={class:"form-card"},T={class:"form-row"},j={class:"form-group"},A={key:0,class:"error-message"},L={class:"form-group"},G={key:0,class:"error-message"},H={key:0,class:"rate-info"},J={class:"info-row"},K={class:"info-value"},O={class:"info-row"},P={class:"info-value"},Q={key:1,class:"calculation-info"},W={class:"info-row"},X={class:"info-value"},Y={class:"info-row"},$={class:"info-value"},ee={class:"info-row total"},se={class:"info-value"},te={key:2,class:"alert alert-error"},ae={class:"form-actions"},oe=["disabled"],ne={__name:"Create",setup(le){const k=E(),t=c({type:"",usd_amount:0}),l=c(null),n=c({}),m=c(null),_=c(!1),y=g(()=>!l.value||!t.value.type?0:t.value.type==="buy"?parseFloat(l.value.buy_rate):parseFloat(l.value.sell_rate)),b=g(()=>!t.value.usd_amount||!y.value?0:t.value.usd_amount*y.value);N(async()=>{await Z()});async function Z(){try{const a=await S.get("/rates/latest");a.data.success&&(l.value=a.data.data)}catch(a){console.error("Error loading rate:",a)}}async function C(){var a,s,v,r;n.value={},m.value=null,_.value=!0;try{(await S.post("/exchanges",t.value)).data.success&&k.push({name:"Exchanges"})}catch(f){(s=(a=f.response)==null?void 0:a.data)!=null&&s.errors&&(n.value=f.response.data.errors),m.value=((r=(v=f.response)==null?void 0:v.data)==null?void 0:r.message)||"Ошибка при создании обмена"}finally{_.value=!1}}function d(a){return new Intl.NumberFormat("ru-RU",{minimumFractionDigits:2,maximumFractionDigits:2}).format(a)}return(a,s)=>{const v=V("router-link");return i(),u("div",q,[e("div",z,[s[3]||(s[3]=e("h1",{class:"page-title"},"Новый обмен валюты",-1)),U(v,{to:"/exchanges",class:"btn btn-secondary"},{default:h(()=>[...s[2]||(s[2]=[D(" ← Назад ",-1)])]),_:1})]),e("div",I,[e("form",{onSubmit:F(C,["prevent"])},[e("div",T,[e("div",j,[s[5]||(s[5]=e("label",{for:"type"},"Тип операции *",-1)),w(e("select",{id:"type","onUpdate:modelValue":s[0]||(s[0]=r=>t.value.type=r),class:x(["form-select",{error:n.value.type}]),required:""},[...s[4]||(s[4]=[e("option",{value:""},"Выберите тип",-1),e("option",{value:"buy"},"Покупка USD (продаем UZS)",-1),e("option",{value:"sell"},"Продажа USD (покупаем UZS)",-1)])],2),[[R,t.value.type]]),n.value.type?(i(),u("span",A,o(n.value.type[0]),1)):p("",!0)]),e("div",L,[s[6]||(s[6]=e("label",{for:"usd_amount"},"Сумма в USD *",-1)),w(e("input",{id:"usd_amount","onUpdate:modelValue":s[1]||(s[1]=r=>t.value.usd_amount=r),type:"number",step:"0.01",class:x(["form-input",{error:n.value.usd_amount}]),placeholder:"0.00",required:""},null,2),[[B,t.value.usd_amount,void 0,{number:!0}]]),n.value.usd_amount?(i(),u("span",G,o(n.value.usd_amount[0]),1)):p("",!0)])]),l.value?(i(),u("div",H,[s[9]||(s[9]=e("div",{class:"info-title"},"Текущий курс",-1)),e("div",J,[s[7]||(s[7]=e("span",null,"Покупка USD:",-1)),e("span",K,o(d(l.value.buy_rate))+" UZS",1)]),e("div",O,[s[8]||(s[8]=e("span",null,"Продажа USD:",-1)),e("span",P,o(d(l.value.sell_rate))+" UZS",1)])])):p("",!0),b.value?(i(),u("div",Q,[e("div",W,[s[10]||(s[10]=e("span",null,"Сумма в USD:",-1)),e("span",X,o(d(t.value.usd_amount))+" USD",1)]),e("div",Y,[s[11]||(s[11]=e("span",null,"Курс:",-1)),e("span",$,o(d(y.value))+" UZS",1)]),e("div",ee,[e("span",null,o(t.value.type==="buy"?"Мы платим UZS:":"Мы получаем UZS:"),1),e("span",se,o(d(b.value))+" UZS",1)])])):p("",!0),m.value?(i(),u("div",te,o(m.value),1)):p("",!0),e("div",ae,[e("button",{type:"submit",class:"btn btn-primary",disabled:_.value},o(_.value?"Создание...":"Создать обмен"),9,oe),U(v,{to:"/exchanges",class:"btn btn-secondary"},{default:h(()=>[...s[12]||(s[12]=[D(" Отмена ",-1)])]),_:1})])],32)])])}}},ie=M(ne,[["__scopeId","data-v-dfbe7467"]]);export{ie as default};
